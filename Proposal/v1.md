# Website Fingerprinting in the Tor Network: Reproduction and Evaluation Under Simulated Laboratory Conditions Using Shadow

## Background and Problem Statement

Tor is widely regarded as the most effective tool for anonymous web browsing. However, Website Fingerprinting (WF) attacks enable a local, passive eavesdropper — such as an ISP or network administrator — to determine which websites a Tor user is visiting by analyzing encrypted traffic metadata alone, without breaking any encryption.

State-of-the-art WF attacks such as Deep Fingerprinting (DF) have demonstrated over 98% classification accuracy against undefended Tor traffic. At the same time, lightweight defenses like Circuit Padding have been integrated into Tor to mitigate these attacks. The effectiveness of these defenses under realistic, reproducible conditions remains an active area of research.

This thesis reproduces an established WF attack (Deep Fingerprinting) within a Shadow-simulated Tor network and systematically evaluates the effectiveness of padding-based countermeasures.

## Research Questions

1. Can an established WF attack (Deep Fingerprinting) be successfully reproduced in a Shadow-simulated Tor environment?
2. How does the size of the monitored website set affect classification accuracy?
3. How effectively do Circuit Padding mechanisms reduce attack accuracy, and at what cost in terms of bandwidth overhead?

## Goals and Expected Results

- A fully documented, reproducible Shadow-based Tor simulation environment suitable for WF research.
- A dataset of Tor cell traces collected at the simulated Guard node position.
- A trained Deep Fingerprinting (CNN) classifier with evaluated performance metrics (accuracy, precision, recall, F1-score).
- A systematic comparison of attack performance with and without Circuit Padding defenses, including bandwidth overhead analysis.
- An ethical reflection on the implications of WF research.

## Methodology

| Phase                            | Description                                                                                                                                                            | Output                                      |
| -------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------- |
| **Phase 1: Simulation Setup**    | Set up Shadow with tornettools to simulate a realistic Tor network based on Tor network metrics. Document the setup process for reproducibility.                       | Documented, reproducible test environment   |
| **Phase 2: Data Collection**     | Generate traffic by having simulated clients fetch 20–50 websites through the Tor network. Extract Tor cell traces (timestamps, direction) at the Guard node position. | Labeled dataset of cell traces              |
| **Phase 3: Attack Reproduction** | Train and evaluate a Deep Fingerprinting classifier (1D-CNN, PyTorch) on the collected cell traces. Evaluate in both closed-world and open-world settings.             | Classification metrics, confusion matrices  |
| **Phase 4: Defense Evaluation**  | Enable Tor's Circuit Padding framework with different configurations. Repeat data collection and classification. Measure accuracy degradation and bandwidth overhead.  | Comparative analysis: accuracy vs. overhead |
| **Phase 5: Documentation**       | Analyze results, discuss limitations, ethical considerations, and write the thesis.                                                                                    | Final thesis                                |

## Tools and Technologies

| Category               | Tools                                              |
| ---------------------- | -------------------------------------------------- |
| **Network Simulation** | Shadow, tornettools, Tor, TGen                     |
| **Web Content**        | Static website mirror (nginx or zimply)            |
| **Data Collection**    | Tor cell trace logging (patched Tor at Guard node) |
| **Machine Learning**   | Python, PyTorch, scikit-learn                      |
| **Visualization**      | matplotlib, seaborn                                |

## Scope Delimitation

The following topics are covered in the theoretical background chapter but are **not** part of the practical evaluation:

- End-to-end traffic correlation attacks
- Timing-based side-channel attacks
- Censorship circumvention (Pluggable Transports, Snowflake)
- Server-side deanonymization / Browser Fingerprinting
- Attacks on Onion Services